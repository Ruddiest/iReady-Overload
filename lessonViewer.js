document.write("List of lessons: <select id=\"lessonSelect\"></select>\n\n<div id=\"data\"></div>\n\n<script>\nvar units = [];\nvar lessons = {};\n\n// gets all units\nfetch(\"https://cdn.i-ready.com/instruction/phoenix/master/121/lessonmap.json\")\n\t.then(response => response.json())\n\n\t// loads units\n\t.then(unitData => units = unitData)\n\t.then(function() {\n\n\t\t// loads lessons from units\n\t\tlessonSelect.innerHTML = \"\";\n\n\t\tlistLessons();\n\n\t\t// loops through every lesson in unit\n\t\tfunction listLessons(i = 0, j = 0) {\n\t\t\tfetch(`https://cdn.i-ready.com/instruction/phoenix-content/${Object.keys(units)[i].includes(\"ELA\") ? \"reading\" : \"math\"}/${Object.keys(units[Object.keys(units)[i]])[j]}/lessonStructure.json`)\n\t\t\t\t.then(response => response.json())\n\t\t\t\t.then(function(lessonData) {\n\n\t\t\t\t\t// adds lessons to lesson select\n\t\t\t\t\tvar lessonOption = document.createElement(\"option\");\n\t\t\t\t\tlessonOption.innerText = lessonData.lessonStructureObj.title;\n\t\t\t\t\tlessonOption.value = Object.keys(units[Object.keys(units)[i]])[j];\n\t\t\t\t\tlessonSelect.appendChild(lessonOption);\n\n\t\t\t\t\t// puts lesson data in lessons object\n\t\t\t\t\tlessons[Object.keys(units[Object.keys(units)[i]])[j]] = lessonData;\n\t\t\t\t\tlessons[Object.keys(units[Object.keys(units)[i]])[j]].unit = Object.keys(units)[i];\n\n\t\t\t\t\t// gets lesson definitions\n\t\t\t\t\tlessons[Object.keys(units[Object.keys(units)[i]])[j]].definitions = [];\n\n\t\t\t\t\t// gets slide data\n\t\t\t\t\tlessons[Object.keys(units[Object.keys(units)[i]])[j]].slides = [];\n\n\t\t\t\t\tfor(var k = 0; k < lessons[Object.keys(units[Object.keys(units)[i]])[j]].lessonStructureObj.slideData.length; k++){\n\t\t\t\t\t\tvar slide = {type: \"unknown\", name: lessons[Object.keys(units[Object.keys(units)[i]])[j]].lessonStructureObj.slideData[k].name};\n\n\t\t\t\t\t\t// video slide\n\t\t\t\t\t\tif(!!lessons[Object.keys(units[Object.keys(units)[i]])[j]].lessonStructureObj.slideData[k].src){\n\t\t\t\t\t\t\tvar src = lessons[Object.keys(units[Object.keys(units)[i]])[j]].lessonStructureObj.slideData[k].src;\n\t\t\t\t\t\t\tslide.type = \"video\";\n\t\t\t\t\t\t\tslide.src = `https://cdn.i-ready.com/instruction/phoenix-content/${Object.keys(units)[i].includes(\"ELA\") ? \"reading\" : \"math\"}/${Object.keys(units[Object.keys(units)[i]])[j]}/${lessons[Object.keys(units[Object.keys(units)[i]])[j]].lessonStructureObj.slideData[k].name}/video/${src}`;\n\t\t\t\t\t\t} else if(!!lessons[Object.keys(units[Object.keys(units)[i]])[j]].lessonStructureObj.slideData[k].timelineAudio) {\n\t\t\t\t\t\t\tvar src = lessons[Object.keys(units[Object.keys(units)[i]])[j]].lessonStructureObj.slideData[k].timelineAudio;\n\t\t\t\t\t\t\tslide.type = \"audio\";\n\t\t\t\t\t\t\tslide.src = `https://cdn.i-ready.com/instruction/phoenix-content/${Object.keys(units)[i].includes(\"ELA\") ? \"reading\" : \"math\"}/${Object.keys(units[Object.keys(units)[i]])[j]}/${lessons[Object.keys(units[Object.keys(units)[i]])[j]].lessonStructureObj.slideData[k].name}/audio/${src}`;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tlessons[Object.keys(units[Object.keys(units)[i]])[j]].slides.push(slide);\n\t\t\t\t\t}\n\n\t\t\t\t\tif(i == 0 && j == 0) lessonSelect.onchange()\n\n\t\t\t\t\t// continues loop if applicable (for loop can not be used because of fetch requests)\n\t\t\t\t\tif (j < Object.keys(units[Object.keys(units)[i]]).length - 1) {\n\n\t\t\t\t\t\t// increases j\n\t\t\t\t\t\tlistLessons(i, j + 1)\n\t\t\t\t\t} else if (i < Object.keys(units).length - 1) {\n\n\t\t\t\t\t\t// increases i\n\t\t\t\t\t\tlistLessons(i + 1);\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\t// done loading\n\t\t\t\t\t\tconsole.log(\"done loading.\");\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t}\n\t});\n\n\tlessonSelect.onchange = function(){\n\t\t// adds basic info\n\t\tdata.innerHTML = `\n\t\t<b>Title:</b> ${lessons[lessonSelect.value].lessonStructureObj.title}<br>\n\t\t<b>Level:</b> ${lessons[lessonSelect.value].lessonStructureObj.title.split(\" - Level \")[1]}<br>\n\t\t<b>Subject:</b> ${lessonSelect.value.includes(\"ELA\") ? \"Reading\" : \"Math\"}<br>\n\t\t<b>Lesson ID:</b> ${lessonSelect.value}<br>\n\t\t<b>Lesson Link:</b> <a href=\"https://cdn.i-ready.com/instruction/phoenix/master/135/?csid=DI.MATH.GEO.8.1005.phx.10_71da0b35-cb71-4540-9e75-73203c6686dc_M_math&type=QUIZ#/lesson/${lessonSelect.value.includes(\"ELA\") ? \"reading\" : \"math\"}/${lessonSelect.value}\">https://cdn.i-ready.com/instruction/phoenix/master/135/?csid=DI.MATH.GEO.8.1005.phx.10_71da0b35-cb71-4540-9e75-73203c6686dc_M_math&type=QUIZ#/lesson/${lessonSelect.value.includes(\"ELA\") ? \"reading\" : \"math\"}/${lessonSelect.value}</a><br>\n\t\t<b>Teacher Lesson Link (doesn't work for every lesson):</b> <a href=\"https://cainc.i-ready.com/lessonPreview.jsf?componentId=${lessonSelect.value.split(\"_\").join(\".\").slice(0, -3)}.phx.${lessonSelect.value.split(\"_\")[lessonSelect.value.split(\"_\").length - 1]}&sc=q\">https://cainc.i-ready.com/lessonPreview.jsf?componentId=${lessonSelect.value.split(\"_\").join(\".\").slice(0, -3)}.phx.${lessonSelect.value.split(\"_\")[lessonSelect.value.split(\"_\").length - 1]}&sc=q</a><br>\n\t\t<b>Large Thumbnail (not all lessons have one):</b> <br> <img width=\"250\" src=\"https://cdn.i-ready.com/instruction/content/dashboard/images/lessonthumbnails/${lessons[lessonSelect.value].unit.toLowerCase().split(\"_\").join(\".\")}.phx_large.jpg\"></img><br><br>\n\t\t<b>Small Thumbnail (not all lessons have one):</b> <br> <img  width=\"250\" src=\"https://cdn.i-ready.com/instruction/content/dashboard/images/lessonthumbnails/${lessons[lessonSelect.value].unit.toLowerCase().split(\"_\").join(\".\")}.phx_small.jpg\"></img><br><br>\n\t\t<b>Lesson Structure File:</b> <a href=\"https://cdn.i-ready.com/instruction/phoenix-content/${lessonSelect.value.includes(\"ELA\") ? \"reading\" : \"math\"}/${lessonSelect.value}/lessonStructure.json\">https://cdn.i-ready.com/instruction/phoenix-content/${lessonSelect.value.includes(\"ELA\") ? \"reading\" : \"math\"}/${lessonSelect.value}/lessonStructure.json</a><br>\n\t\t<b>Slide Count:</b> ${lessons[lessonSelect.value].lessonStructureObj.slideData.length} <br>\n\t\t<b>Slide Files:</b><br>`\n\n\t\t// adds slide files\n\t\tfor(var i = 0; i < lessons[lessonSelect.value].slides.length; i++){\n\t\t\tvar slide = lessons[lessonSelect.value].slides[i];\n\t\t\tif(slide.type != \"unknown\") data.innerHTML += `<br><i>\"${slide.src.split(\"/\")[slide.src.split(\"/\").length - 1]}\"</i> <br> <video controls width=\"250\" src=\"${slide.src}\"></video> <br>`\n\t\t}\n\t}\n</script>\n");